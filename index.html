<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ãŸã‹ã¡ã‚ƒã‚“å¾©æ´»MAP</title>
    <style>
        body { margin: 0; padding: 0; font-family: sans-serif; }
        #map { height: 100vh; width: 100vw; background: #eee; } /* èª­ã¿è¾¼ã¿å‰ã¯ã‚°ãƒ¬ãƒ¼ */
        .control-panel { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); z-index: 1000; width: 95%; display: flex; gap: 10px; }
        button { flex: 1; padding: 15px; border-radius: 12px; border: none; font-size: 16px; font-weight: bold; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .gps-btn { background: #007aff; color: #fff; }
        #input-form { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; background: white; z-index: 3000; display: none; padding: 20px; border-radius: 15px; }
        input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ccc; border-radius: 8px; font-size: 16px; box-sizing: border-box; }
    </style>
</head>
<body>
    <div id="map">åœ°å›³ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>

    <div id="input-form">
        <b style="display:block; text-align:center;">ğŸ“Š å£²ä¸Šã‚’è¨˜éŒ²</b>
        <input type="number" id="sales-input" placeholder="å£²ä¸Šï¼ˆå††ï¼‰" inputmode="numeric">
        <input type="text" id="area-input" placeholder="åœ°åŸŸï¼ˆè‡ªå‹•ï¼‰">
        <button style="background:#ffcc00; width:100%;" onclick="saveMemo()">âœ… ä¿å­˜</button>
        <button style="background:#eee; width:100%; margin-top:10px;" onclick="closeForm()">é–‰ã˜ã‚‹</button>
    </div>

    <div class="control-panel">
        <button class="gps-btn" onclick="goToCurrentLocation()">ğŸ“ ç¾åœ¨åœ°ã¸ç§»å‹•</button>
    </div>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAi0_BQ9-5c3-7sTh1rwevVJlOsYxoLR_4&callback=initMap&libraries=places"></script>

    <script>
        let map, geocoder, curLat, curLng;

        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                center: {lat: 33.5902, lng: 130.4017},
                zoom: 16,
                disableDefaultUI: true
            });
            geocoder = new google.maps.Geocoder();

            map.addListener('click', e => {
                curLat = e.latLng.lat();
                curLng = e.latLng.lng();
                document.getElementById('input-form').style.display = 'block';
                geocoder.geocode({ location: e.latLng }, (results, status) => {
                    if (status === "OK" && results[0]) {
                        document.getElementById('area-input').value = results[0].formatted_address.replace("æ—¥æœ¬ã€", "");
                    }
                });
            });
            goToCurrentLocation();
        }

        function goToCurrentLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(pos => {
                    curLat = pos.coords.latitude;
                    curLng = pos.coords.longitude;
                    const latlng = {lat: curLat, lng: curLng};
                    map.setCenter(latlng);
                    map.setZoom(17);
                    new google.maps.Marker({ position: latlng, map: map, icon: { path: google.maps.SymbolPath.CIRCLE, scale: 10, fillColor: '#007aff', fillOpacity: 1, strokeWeight: 3, strokeColor: 'white' } });
                }, (err) => {
                    alert("GPSã‚¨ãƒ©ãƒ¼: " + err.message + "\nã‚¹ãƒãƒ›ã®è¨­å®šã§ä½ç½®æƒ…å ±ã‚’è¨±å¯ã—ã¦ã­ï¼");
                });
            }
        }

        function saveMemo() {
            const sales = document.getElementById('sales-input').value;
            if(!sales) { alert("å£²ä¸Šã‚’å…¥ã‚Œã¦ã­ï¼"); return; }
            alert("ä¿å­˜ã—ã¾ã—ãŸï¼ï¼ˆä»®ï¼‰\nâ€»çœŸã£ç™½ãŒç›´ã£ãŸã‚‰ãƒªã‚¹ãƒˆæ©Ÿèƒ½ã‚‚æˆ»ã™ã‘ã‚“ã­ï¼");
            closeForm();
        }
        function closeForm() { document.getElementById('input-form').style.display = 'none'; }
    </script>
</body>
</html>
